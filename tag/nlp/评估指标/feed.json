{
    "version": "https://jsonfeed.org/version/1",
    "title": "且听风吟，御剑于心！ • All posts by \"nlp/评估指标\" tag",
    "description": "",
    "home_page_url": "https://leezhao415.github.io",
    "items": [
        {
            "id": "https://leezhao415.github.io/2021/08/08/%E5%B8%B8%E8%A7%81%E7%9A%84NLG%E8%AF%84%E4%BC%B0%E6%8C%87%E6%A0%87/",
            "url": "https://leezhao415.github.io/2021/08/08/%E5%B8%B8%E8%A7%81%E7%9A%84NLG%E8%AF%84%E4%BC%B0%E6%8C%87%E6%A0%87/",
            "title": "常见的NLG评估指标",
            "date_published": "2021-08-08T09:41:58.000Z",
            "content_html": "<meta name=\"referrer\" content=\"no-referrer\">\n<hr>\n<p><strong>文章目录</strong></p>\n<!-- toc -->\n<ul>\n<li><a href=\"#%E5%B8%B8%E8%A7%81%E7%9A%84nlg%E8%AF%84%E4%BC%B0%E6%8C%87%E6%A0%87\">常见的 NLG 评估指标</a>\n<ul>\n<li><a href=\"#%E5%BC%95%E8%A8%80\">引言</a></li>\n<li><a href=\"#bleu%E8%AF%84%E4%BC%B0%E6%B3%95%E6%9C%BA%E5%99%A8%E7%BF%BB%E8%AF%91\">BLEU 评估法（机器翻译）</a></li>\n<li><a href=\"#rouge%E8%AF%84%E4%BC%B0%E6%B3%95%E8%87%AA%E5%8A%A8%E6%91%98%E8%A6%81\">ROUGE 评估法（自动摘要）</a></li>\n<li><a href=\"#rouge-n\">Rouge-N</a></li>\n<li><a href=\"#rouge-l\">Rouge-L</a></li>\n<li><a href=\"#rouge-w\">Rouge-W</a></li>\n<li><a href=\"#rouge-s\">Rouge-S</a></li>\n<li><a href=\"#meteor%E8%AF%84%E4%BC%B0%E6%B3%95%E6%9C%BA%E5%99%A8%E7%BF%BB%E8%AF%91-%E8%87%AA%E5%8A%A8%E6%96%87%E6%91%98\">METEOR 评估法（机器翻译、自动文摘）</a></li>\n<li><a href=\"#cider%E8%AF%84%E4%BB%B7%E6%96%B9%E6%B3%95\">CIDEr 评价方法</a></li>\n</ul>\n</li>\n</ul>\n<!-- tocstop -->\n<hr>\n<h2><span id=\"常见的-nlg-评估指标\"> 常见的 NLG 评估指标</span></h2>\n<h3><span id=\"引言\"> 引言</span></h3>\n<p>如何判定训练出来的模型好与坏呢？关键是要有一个比较好的模型评估方法，那么今天作者就给大家汇总一下自然语言生成（NLG）中经常见到的无监督自评估方法（BLEU、METEOR、ROUGE、CIDEr）（<a href=\"https://link.zhihu.com/?target=https%3A//github.com/Maluuba/nlg-eval\">含评估代码</a>）。</p>\n<h3><span id=\"bleu-评估法机器翻译\"> BLEU 评估法（机器翻译）</span></h3>\n<p>Bleu 全称为 Bilingual Evaluation Understudy（双语评估研究） ，意为双语评估替换，是 IBM 在 2002 年提出的用于机器翻译的一个评测指标，是衡量一个有多个正确输出结果的模型的精确度的评估指标。</p>\n<p>BLEU 的设计思想与评判机器翻译好坏的思想是一致的：机器翻译结果越接近专业人工翻译的结果，则越好。BLEU 算法实际上在做的事：判断两个句子的相似程度。我想知道一个句子翻译前后的表示是否意思一致，显然没法直接比较，那我就拿这个句子的标准人工翻译与我的机器翻译的结果作比较，如果它们是很相似的，说明我的翻译很成功。因此，BLUE 去做判断：一句机器翻译的话与其相对应的几个参考翻译作比较，算出一个综合分数。这个分数越高说明机器翻译得越好。</p>\n<p>举个例子：下面拿中英机器翻译做例子：</p>\n<p>中文：垫上有一只老鼠。</p>\n<p>参考翻译 1：The cat is on the mat.</p>\n<p>参考翻译 1：There is a cat on the mat.</p>\n<p>MT (机器翻译):the cat the cat on the mat.</p>\n<p>bleu 的得分有<strong>一元组</strong>，<strong>二元组</strong>，<strong>三元组</strong>等等，这里做了 1-3 元组的例子，如下：</p>\n<p>下面先计算<strong> BELU 一元组</strong>得分，即先把 MT 输出的句子拆分成 the,cat,on,mat，频数分别为 3,2,1,1:</p>\n<center><img src=\"https://pic4.zhimg.com/80/v2-8ae2d3fadb00a63a5e73e9eb13dbf0ab_720w.jpg\" alt=\"img\" style=\"zoom:80%;\"></center>\n<p>上面的 Count (clip) 叫截取计数，是取每个单词在所有参考翻译句子中，出现最多的次数，the 在参考翻译 1 中出现 2 次，在参考翻译 2 中出现 1 次，所以 the 的 Count (clip) 取最大值就是 2，剩下的单词依次类推。</p>\n<p>所以 BLEU 的一元组上的得分为： p1 = Count (clip)/Count=（2+1+1+1）/(3+2+1+1) =5/7</p>\n<p>下面再计算<strong> BLEU 的二元组</strong>得分：</p>\n<p>参考翻译 1：The cat is on the mat.</p>\n<p>参考翻译 1：There is a cat on the mat.</p>\n<p>MT (机器翻译):the cat the cat on the mat.</p>\n<center><img src=\"https://pic2.zhimg.com/80/v2-f2c6f109284c59bd0887e4a0137a9995_720w.jpg\" alt=\"img\" style=\"zoom:80%;\"></center>\n<p>所以 bleu 的二元组的得分为：p2 = Count (clip)/Count=（1+0+1+1+1）/(2+1+1+1+1) =4/6=2/3</p>\n<p>同理<strong> BELU 的三元组</strong>得分：</p>\n<p>参考翻译 1：The cat is on the mat.</p>\n<p>参考翻译 1：There is a cat on the mat.</p>\n<p>MT (机器翻译):the cat the cat on the mat.</p>\n<center><img src=\"https://pic1.zhimg.com/80/v2-993d4d0704d91edd23292ed2827fa934_720w.jpg\" alt=\"img\" style=\"zoom:80%;\"></center>\n<p>所以 bleu 的三元组的得分为：p3 = Count (clip)/Count= 2/5；最后加所有元组的 bleu 得分都加起来然后取平均数得:     bleu（avg） = （p1+p2+p3）/3 = (5/7+2/3+2/5)/3 = 0.594</p>\n<p>最后再乘上一个 “简短惩罚” BP（brevity penalty），即最后的 bleu 得分为：Bleu (total)=BP * bleu (avg)。</p>\n<p><strong>这里为什么要乘以 BP</strong>：如果 MT 输出了一个非常短的翻译，那么会更容易得到一个高精度的 bleu，因为输出的大部分词都会出现在参考翻译中，所以我们并不想要特别短的翻译结果，所以加入 BP 这么一个调整因子：</p>\n<center><img src=\"https://pic4.zhimg.com/80/v2-e7c0d7ce113d96155364a08e09ba5c23_720w.jpg\" alt=\"img\" style=\"zoom:80%;\"></center>\n<p>上式中，r 为参考翻译的句子长度，c 为 MT 的输出句子长度，若 c&lt;=r , 则 0&lt;exp (1-r/c)&lt;=1, 得分 bleu (avg) 就会乘以小于 1 的系数 ，从而被 “惩罚”。 那么最后：Bleu (total)=BP*bleu (avg)</p>\n<h3><span id=\"rouge-评估法自动摘要\"> ROUGE 评估法（自动摘要）</span></h3>\n<p>Rouge (recall-oriented understanding for gisting evaluation) 是评估自动文摘以及机器翻译的一组指标。</p>\n<p>论文链接地址：<a href=\"https://link.zhihu.com/?target=http%3A//citeseer.ist.psu.edu/viewdoc/download%3Bjsessionid%3D368956B77243860A93FC0E3726EE7919%3Fdoi%3D10.1.1.111.9426%26rep%3Drep1%26type%3Dpdf\">http://citeseer.ist.psu.edu/viewdoc/download</a></p>\n<p>该方法的主要是思想是：由多个专家分别生成人工摘要，构成标准摘要集。将系统生成的自动摘要与人工生成的标准摘要相对比，通过统计二者之间重叠的基本单元（n 元语法、词序列和词对）的数目，来评价摘要的质量。通过多专家人工摘要的对比，提高评价系统的稳定性和健壮性。该方法现在已经成为摘要评价技术的通用标准之一。关于该算法演变评价标准有：Rouge-N、Rouge-L、Rouge-S、Rouge-W、Rouge-SU。</p>\n<h3><span id=\"rouge-n\"> Rouge-N</span></h3>\n<center><img src=\"https://pic3.zhimg.com/80/v2-30791390edaa5d66a779be534b936646_720w.jpg\" alt=\"img\" style=\"zoom:80%;\"></center>\n<p>其中，n 表示 n-gram 的长度，{Reference Summaries} 表示参考摘要，即事先获得的标准摘要，<em>Count<sub>m</sub>atch (gram<sub>n</sub>)</em>  表示候选摘要和参考摘要中同时出现 n-gram 的个数，<em>Count (gram<sub>n</sub>)</em>  则表示参考摘要中出现的 n-gram 个数。不难看出，ROUGE 公式是由召回率的计算公式演变而来的，分子可以看作 “检出的相关文档数目”，即系统生成摘要与标准摘要相匹配的 N-gram 个数，分母可以看作 “相关文档数目”，即标准摘要中所有的 N-gram 个数。具体计算方式具体如下：</p>\n<center><img src=\"https://pic4.zhimg.com/80/v2-9fa38c74b2926581e7284e613aaf76ff_720w.jpg\" alt=\"img\" style=\"zoom:89%;\"></center>\n<p>通过上面可以看到其实 ROUGE-N 和 BLEU 几乎一模一样，区别是 BLEU 只计算准确率，而 ROUGE 只计算召回率。</p>\n<p><strong>优点</strong>：直观，简介，能反映词序。</p>\n<p><strong>缺点</strong>：区分度不高，且当 N&gt;3 时，ROUGE-N 值通常很小。</p>\n<p><strong>应用场景</strong>：ROUGE-1：短摘要评估，多文档摘要（去停用词条件）;ROUGE-2: 单文档摘要，多文档摘要（去停用词条件）;</p>\n<h3><span id=\"rouge-l\"> Rouge-L</span></h3>\n<p>子序列：一个给定序列的子序列就是该给定序列中去掉零个或者多个元素。</p>\n<p>公共子序列：给定两个序列 X 和 Y，如果 Z 既是 X 的一个子序列又是 Y 的一个子序列，则序列 Z 是 X 和 Y 的一个公共子序列。</p>\n<p>LCS（最长公共子序列）：给定两个序列 X 和 Y，使得公共子序列长度最大的序列是 X 和 Y 的最长公共子序列。其计算公式为：</p>\n<center><img src=\"https://pic2.zhimg.com/80/v2-7bac4d4bd9cb519c6280a7c32ae0bfd1_720w.jpg\" alt=\"img\" style=\"zoom:80%;\"></center>\n<p>其中<em> X</em> 为参考摘要，长度为<em> m</em>，<em>Y</em> 为候选摘要，长度为<em> n</em>，用<em> F</em> 值来衡量摘要<em> X</em> 与<em> Y</em> 的相似度，在 DUC 测评中，由于<em> β</em>—&gt;+∞，所以只考虑<em> R<sub>lcs</sub></em>  。具体计算例子如下：</p>\n<center><img src=\"https://pic3.zhimg.com/80/v2-27439099bdb83809c4b222cfac62ad2e_720w.jpg\" alt=\"img\" style=\"zoom:90%;\"></center>\n<p><strong>优点</strong>：不要求词的连续匹配，只要求按词的出现顺序匹配即可，能够像 n-gram 一样反映句子级的词序。自动匹配最长公共子序列，不需要预先定义 n-gram 的长度。</p>\n<p><strong>缺点</strong>：只计算一个最长子序列，最终的值忽略了其他备选的最长子序列及较短子序列的影响。</p>\n<p><strong>应用场景</strong>：单文档摘要；短摘要评估。</p>\n<center><img src=\"https://pic3.zhimg.com/80/v2-86f9db9ab475873fc5ed03d163ae6d1a_720w.jpg\" alt=\"img\" style=\"zoom:80%;\"></center>\n<p>将 LCS 应用到摘要级数相时，对参考摘要中的每一个句子 *r<sub>i</sub><em> 与候选摘要中的所有句子比对，以 union LCS 作为摘要句</em> r<sub>i</sub> * 的匹配结果。计算公式：</p>\n<center><img src=\"https://pic4.zhimg.com/80/v2-653d0fe4c5691d5a23632ce74d09e6af_720w.png\" alt=\"img\" style=\"zoom:80%;\"></center>\n<p>其中<em> R</em> 为参考摘要，包含<em> u</em> 个句子，<em>m</em> 个词，<em>C</em> 为候选摘要，包含<em> v</em> 个句子，<em>n</em> 个词，长度为<em> n</em>，<em>LCS<sub>U</sub>(r<sub>i</sub>，C)</em> 是句子<em> r<sub>i</sub><em> 和候选摘要</em> C</em> 的 union LCS。</p>\n<center><img src=\"https://pic1.zhimg.com/80/v2-9cb58863ae0d12818f1292b0c973c4c4_720w.jpg\" alt=\"img\" style=\"zoom:90%;\"></center>\n<h3><span id=\"rouge-w\"> Rouge-W</span></h3>\n<p>为使连续匹配比不连续匹配赋予更大的权重，公式描述如下：</p>\n<center><img src=\"https://www.zhihu.com/equation?tex=f%28x%2By%29%3Ef%28x%29%2Bf%28y%29\" alt=\"[公式]\" style=\"zoom:90%;\"></center>\n<p>例如 <em>f(k) = k<sup>α</sup></em>，α&gt;1 ，同时为了归一化最终的 Rouge-W 的值，通常选择函数与反函数具有相似形式的函数。例如：  <em>f(k) = k<sup>2</sup></em>, <em>f<sup>-1</sup> = k<sup>1/2</sup></em> ，具体计算公式如下所示：</p>\n<center><img src=\"https://pic1.zhimg.com/80/v2-f7cfe012de24608676367e6b1627c874_720w.jpg\" alt=\"img\" style=\"zoom:80%;\"></center>\n<p>举个例子如下：</p>\n<center><img src=\"https://pic1.zhimg.com/80/v2-1cb9caf59f0549f5fcab3f1bf88a7260_720w.jpg\" alt=\"img\" style=\"zoom:95%;\"></center>\n<p><strong>优点</strong>：同一 LCS 下，对连续匹配词数多的句子赋予更高权重，比 LCS 区分度更高。</p>\n<p><strong>缺点</strong>：同 ROUGE-L，只计算一个最长子序列，最终的值忽略了其他备选的最长子序列及较短子序列的影响。</p>\n<p><strong>应用场景</strong>：单文档摘要；短摘要评估。</p>\n<h3><span id=\"rouge-s\"> Rouge-S</span></h3>\n<p>Skip-Bigram 是按句子顺序中的任何成对词语。计算公式如下：</p>\n<center><img src=\"https://pic4.zhimg.com/80/v2-86e38cbfc3b109917ad542980aca3d47_720w.jpg\" alt=\"img\" style=\"zoom:80%;\"></center>\n<p>其中 X 为参考摘要，长度为 m，Y 为候选摘要，长度为 n。SKIP2 (X，Y) 表示候选摘要与参考摘要的 skip-bigram 匹配次数。</p>\n<p>Skip-gram 如果不限制跳跃的距离，会出现很多无意义的词对，比如 “the of”、“in the” 等。为了减少无意义词对的出现，可以限制最大跳跃距离<em> d<sub>skip</sub></em>，通常写 ROUGE-S4 表示最大跳跃距离为 4，ROUGE-S9 表示最大跳跃距离为 9，依次类推。如果 <em>d<sub>skip</sub></em> 为 0，那么 ROUGE-S0 = ROUGE-2。举个例子如下：</p>\n<center><img src=\"https://pic4.zhimg.com/80/v2-4d5addc579f85b2185f2b9e3b26f49bf_720w.jpg\" alt=\"img\" style=\"zoom:95%;\"></center>\n<center><img src=\"https://pic1.zhimg.com/80/v2-7bf0d2e1cc39843f4d5663ca70992f3c_720w.jpg\" alt=\"img\" style=\"zoom:90%;\"></center>\n<p><strong>优点</strong>：考虑了所有按词序排列的词对，比 n-gram 模型更深入反映句子级词序。</p>\n<p><strong>缺点</strong>：若不设定最大跳跃词数会出现很多无意义词对。若设定最大跳跃词数，需要指定最大跳跃词数的值。</p>\n<p><strong>应用场景</strong>：单文档摘要；ROUGE-S4，ROUGE-S9: 多文档摘要（去停用词条件)。</p>\n<h3><span id=\"meteor-评估法机器翻译-自动文摘\"> METEOR 评估法（机器翻译、自动文摘）</span></h3>\n<p>2004 年，卡内基梅隆大学的 Lavir 提出评价指标中召回率的意义，基于此研究，Banerjee 和 Lavie（Banerjee and Lavie, 2005）发明了基于单精度的加权调和平均数和单字召回率的 METEOR 度量方法，目的是解决 BLEU 标准中的一些固有缺陷。</p>\n<p>论文链接地址：<a href=\"https://link.zhihu.com/?target=http%3A//www.cs.cmu.edu/~alavie/METEOR/pdf/Banerjee-Lavie-2005-METEOR.pdf\">http://www.cs.cmu.edu/~alavie/METEOR/pdf/Banerjee-Lavie-2005-METEOR.pdf</a></p>\n<p>METEOR 扩展了 BLEU 有关 “共现” 的概念，提出了三个统计共现次数的模块：一是 “绝对” 模块（“exact” module），即统计待测译文与参考译文中绝对一致单词的共现次数；二是 “波特词干” 模块（porter stem module），即基于波特词干算法计算待测译文与参考译文中词干相同的词语 “变体” 的共现次数，如 happy 和 happiness 将在此模块中被认定为共现词；三是 “WN 同义词” 模块（WN synonymy module），即基于 WordNet 词典匹配待测译文与参考译文中的同义词，计入共现次数，如 sunlight 与 sunshine。</p>\n<p>同时 METEOR 将词序纳入评估范畴，设立基于词序变化的罚分机制，当待测译文词序与参考译文不同时，进行适当的罚分。最终基于共现次数计算准确率、召回率与 F 值，并考虑罚分最终得到待测译文的 METEOR 值。</p>\n<p>该算法首先计算 unigram 情况下的准确率 P 和召回率 R（计算方式与 BLEU、ROUGE 类似），得到调和均值 F 值：</p>\n<center><img src=\"https://www.zhihu.com/equation?tex=F%3D%5Cfrac%7B%28%5Calpha%5E2%2B1%29P%7D%7BR%2B%5Calpha+P%7D\" alt=\"[公式]\" style=\"zoom:90%;\"></center>\n<p>看到这可能还没有什么特别的。Meteor 的特别之处在于，它不希望生成很 “碎” 的译文：比如参考译文是 “A B C D”，模型给出的译文是 “B A D C”，虽然每个 unigram 都对应上了，但是会受到很严重的惩罚。惩罚因子的计算方式为：</p>\n<center><img src=\"https://www.zhihu.com/equation?tex=Penalty%3D%5Cgamma+%28%5Cfrac%7Bchunks%7D%7Bunigrams%5C_matched%7D%29%5E%7B%5Ctheta%7D\" alt=\"[公式]\" style=\"zoom:90%;\"></center>\n<p>上式中的<em> chunks</em> 表示匹配上的语块个数，如果模型生成的译文很碎的话，语块个数会非常多；<em>unigrams_matched</em> 表示匹配上的 unigram 个数。所以最终的评分为：</p>\n<center><img src=\"https://www.zhihu.com/equation?tex=Meteor%3D%281-Penalty%29%5Ccdot+F\" alt=\"[公式]\" style=\"zoom:90%;\"></center>\n<p>用于机器翻译评测时，通常取 α = 3，γ = 0.5，θ = 3。</p>\n<p>自从 2004 年以来，该团队也在不断的对 METEOR 评估方法进行优化，具体可见：<a href=\"https://link.zhihu.com/?target=http%3A//www.cs.cmu.edu/~alavie/METEOR/index.html\">http://www.cs.cmu.edu/~alavie/METEOR/index.html</a></p>\n<h3><span id=\"cider-评价方法\"> CIDEr 评价方法</span></h3>\n<p>CIDEr（Consensuus-based Image Description Evaluation）评价标准是 Vedantm 在 2015 年计算机视觉与模式识别大会上提出来的针对图像摘要问题的度量标准。</p>\n<p>论文链接地址为：<a href=\"https://link.zhihu.com/?target=https%3A//arxiv.org/pdf/1411.5726.pdf\">https://arxiv.org/pdf/1411.5726.pdf</a></p>\n<p>研究者认为过去的多种评价方法和人类评价具有较强的相关性，但是无法统一到一个度量标准来评价与人的相似性（human-like），为了解决这个问题，从而评价计算机自动生成的句子到底有多像人工书写的，Vedantam 等人提出了基于共识的评价标准（consensus-based protocol），其基本工作原理就是通过度量带测评语句与其他大部分人工描述句之间的相似性来评价相似性。研究者证明 CIDEr 在与人工共识的匹配度上要好于前述其它评价指标。</p>\n<p>CIDEr 首先将 n-grams 在参考句子中的出现频率编码进来，n-gram 在数据集所有图片中经常出现的图片的权重应该减少，因为其包含的信息量更少，该权重研究者通过 TF-IDF 计算每个 n-gram 的权重。将句子用 n-gram 表示成向量形式，每个参考句和待评测句之间通过计算 TF-IDF 项链的余玄距离来度量其相似性。</p>\n",
            "tags": [
                "人工智能",
                "NLP/评估指标"
            ]
        }
    ]
}